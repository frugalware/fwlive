#!/bin/sh

# (c) 2007 Miklos Vajna <vmiklos@frugalware.org>
# (c) 2006 Krisztian VASAS <iron@frugalware.org>
# parse_cmdline for Frugalware
# distributed under GPL License

deflang="@FWLLLANG@"

lang=`grep network /proc/cmdline|sed 's/.*lang=\([^ ]*\)\( .*\|$\)/\1/'`
if [ -z "$lang" ]; then
	lang=$deflang
fi
fwlcp=$(grep $lang /usr/share/locale/locale.alias|sed 's/.*\.//;q'|tr [A-Z] [a-z])

case $lang in
	en_*)
	keymap=us
	;;
	*)
	keymap=`echo $lang |sed 's/_.*//'`
	;;
esac
cat << EOF > /etc/sysconfig/keymap
# /etc/sysconfig/keymap

keymap=$keymap
EOF
cat << EOF > /etc/profile.d/lang.sh
export LANG=$lang
export LC_ALL=\$LANG
export CHARSET=$fwlcp
EOF
chmod +x /etc/profile.d/lang.sh
export LC_ALL=$lang
